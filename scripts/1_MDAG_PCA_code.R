######################################################
#MuViSU
#MDAG 2024 workshop
#PCA code chunks
#18 November 2024
######################################################

biplot(data = iris,
       group.aes = iris[,5], 
       Title = "My first biplot")


X <- as.data.frame(matrix(c(13.5471	,	12.6356	,	21.7779	,
                            7.8248	,	4.4579	,	8.4648,
                            15.3202	,	5.433	,	20.4339	,
                            16.9528	,	11.8832 ,	21.8291,
                            18.3664	,	14.733	,	28.2576,
                            18.0205	,	9.36	,	25.1894,
                            17.5986	,	13.0341	,	21.5221	,
                            13.6643	,	11.2316	,	13.9913,
                            19.3081	,	11.7703	,	28.3937	,
                            17.7739	,	12.4688	,	19.3321,
                            20.3395	,	10.98	,	23.1621	,
                            15.7187	,	14.7718	,	18.7206	,
                            11.6222	,	17.9957	,	21.4343,
                            14.4965	,	15.3002	,	20.6371	,
                            20.2114	,	8.0871	,	22.4164,
                            19.5328	,	11.8101	,	22.1391,
                            16.1871	,	10.0019	,	16.2823,
                            17.5598	,	10.0402	,	20.3788,
                            17.2416	,	13.5807	,	25.4979,
                            16.2913	,	14.9305	,	22.9105,
                            17.7401	,	15.5304	,	22.6354,
                            8.5554	,	12.2874	,	12.9827,
                            11.1397	,	12.4292	,	18.0374,
                            11.993	,	13.4574	,	21.6548,
                            10.7568	,	6.6412	,	17.6931), nrow=25,ncol=3,byrow=T))

X = rbind(X[1:15,]/2.5,X[1:10,]/2.2)
colnames(X) <- c("X1","X2","X3")
X


biplot(X) |> PCA() |> samples(label=TRUE,col="blue",opacity = 0.6) |> axes(which=NULL) |> plot()


bp <- biplot(X) |> PCA() |> samples(label=TRUE,col="blue",opacity = 0.6) |> axes(which=NULL) |> plot()
arrows(0,0,bp$Vr[1,1]*3,bp$Vr[1,2]*3,length=0.08)
arrows(0,0,bp$Vr[2,1]*3,bp$Vr[2,2]*3,length=0.08)
arrows(0,0,bp$Vr[3,1]*3,bp$Vr[3,2]*3,length=0.08)



# PCA()


## ----------------------------------------------------------------------------------------------------------------------
tibble(iris)


## ----------------------------------------------------------------------------------------------------------------------
biplot(data = iris, group.aes = iris[,5],
       Title = "My first biplot") |> 
  PCA() |> 
  plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris, group.aes = iris[,5]) |> 
  PCA() |> 
  samples(col = c("orange","purple","gold"), pch = c(15,1,17), cex = 1.2, 
          opacity = 0.6) |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris, group.aes = iris[,5]) |> 
  PCA() |> 
  samples(which = c(1,2), col = c("orange","purple"), label = TRUE) |> 
  plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:4]) |> PCA() |> samples(col = "grey", opacity = 0.5) |>
  axes(col = "rosybrown", label.dir = "Orthog", lwd = 2) |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:4]) |> PCA() |> samples(col = "grey", opacity = 0.5) |>
  axes(which = 1:2, col = "rosybrown", vectors = TRUE, unit.circle = TRUE) |> 
  plot()


## ----------------------------------------------------------------------------------------------------------------------
out <- biplot(iris[,1:4], group.aes = iris[,5]) |> PCA() |> 
  samples(col = c("orange","purple","gold"), opacity = 0.5) |>
  prediction(predict.samples = c(1:2,51:52,101:102) )|>
  axes(predict.col = "red", predict.lwd = 1.5, predict.lty = 2) |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:4], group.aes = iris[,5]) |> PCA() |> 
  samples(col = c("orange","purple","gold"), opacity = 0.5) |>
  prediction(predict.samples = c(1:2,51:52,101:102), which = "Sepal.Length")|>
  axes(predict.col = "red", predict.lwd = 1.5, predict.lty = 2) |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:4], group.aes = iris[,5]) |> PCA(show.class.means = TRUE) |> 
  samples(col = c("orange","purple","gold"), opacity = 0.5) |>
  prediction(predict.means = TRUE) |>
  axes(predict.col = "red", predict.lwd = 1.5, predict.lty = 2) |> plot()


## ----------------------------------------------------------------------------------------------------------------------
summary(out)


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[1:100,]) |> PCA() |> 
  interpolate (newdata = iris[101:150,]) |> 
  newsamples(col = "red") |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:3]) |> PCA() |> 
    interpolate(newdata = NULL, newvariable = iris[,4]) |> 
    newaxes(X.new.names = "Petal.Width") |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris)|> 
      PCA(group.aes = iris[,5]) |> 
      translate_axes(swop=TRUE, delta = 0.2)|> plot(exp.factor = 3)


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:4],group.aes = iris[,5]) |> PCA() |> 
  density2D(which = 1, col = c("white","purple","cyan","blue")) |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:4], group.aes = iris[,5]) |> PCA() |> 
  density2D(which = 2, col = c("white","purple","cyan","blue"),
            contours = TRUE) |> plot()


## ----------------------------------------------------------------------------------------------------------------------
biplot(iris[,1:4],group.aes = iris[,5]) |> PCA() |> 
  density2D(which = 3, col = c("white","purple","cyan","blue"),contours = TRUE,
            contour.col = "grey") |> plot()


## ----------------------------------------------------------------------------------------------------------------------
out2 <- biplot(iris[,1:4],group.aes = iris[,5]) |> PCA() |> fit.measures()
summary(out2)